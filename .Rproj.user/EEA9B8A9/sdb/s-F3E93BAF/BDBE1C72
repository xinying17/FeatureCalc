{
    "contents" : "new_feature_type3 <- function(data_trainm,train_label,data_testm,classes,p,corr,powerS,nc){\n  if(missing(powerS)){\n    powerS=1\n  }\n\n  if(missing(p)){\n    p=0\n  }\n\n  if(missing(corr)){\n    corr=0\n  }\n\n  if(missing(nc)){\n    nc=1\n  }\n\n   # network classifier with 2*nc networks\n\n  train_nets <- structure(list(types = character(),\n                               featureIDX = list(),\n                               nets = list()))\n\n  # build network for each class\n  aa = 1\n  for(t in classes){\n    class_train <- data_trainm[train_label==t,]\n    clusters <- hclust(dist(t(as.matrix(class_train))),method = \"ward.D\")\n    clusterCut <- cutree(clusters, nc)\n    for(i in 1:nc){\n      x = data.frame(class_train[,clusterCut==i])\n      if(ncol(x)>2){\n        nets <- network_build(as.matrix(x), p, corr)\n        train_nets$types[[aa]] <- t\n        train_nets$featureIDX[[aa]] <- colnames(x)\n        train_nets$nets[[aa]] <- nets\n        aa = aa+1\n      }\n    }\n\n  }\n  new_train <- matrix(nrow = nrow(data_trainm),ncol = length(train_nets$types))\n  new_test <- matrix(nrow = nrow(data_testm),ncol = length(train_nets$types))\n\n  # new train data\n  for(b in 1:length(train_nets$types)){\n    nets <- train_nets$nets[[b]]\n    smooth_value <- smoothness(Lap = nets$laplacian,\n                               data_trainm[,train_nets$featureIDX[[b]]],powerS)\n    new_train[,b] <- smooth_value\n  }\n\n  # new test data\n  for(b in 1:length(train_nets$types)){\n    nets <- train_nets$nets[[b]]\n    smooth_value <- smoothness(nets$laplacian,\n                               data_testm[,train_nets$featureIDX[[b]]],powerS)\n    new_test[,b] <- smooth_value\n  }\n\n  new_data <- rbind(new_train,new_test)\n\n  return(new_data)\n}\n",
    "created" : 1514931536460.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1196680319",
    "id" : "BDBE1C72",
    "lastKnownWriteTime" : 1514931569,
    "path" : "~/Codes/R/FeatureCalc/R/new_featrue_type3.R",
    "project_path" : "R/new_featrue_type3.R",
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "type" : "r_source"
}